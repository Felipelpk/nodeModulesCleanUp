#!/bin/bash

# Base directory where you want to start the search
base_dir=""

# Output file name
output_file="node_modules_list.txt"

# Full path to output file
output_path="$(pwd)/$output_file"

# Find all node_modules folders within the base directory
# and execute the 'du' command to get the size of each folder
# the 'sort' command orders the result by size (in kilobytes) in descending order
# the 'awk' command adds the directory name in front of the size
# and the 'sed' command formats the output to have a list of directories and their sizes in descending order
find "$base_dir" -type d -name "node_modules" -print0 | xargs -0 du -sk | sort -rn | awk '{printf "%dMB\t%s\n", $1/1024, $2}' | sed 's/ / \t/' > "$output_path"

echo "Listing of node_modules folders completed! Results saved in $output_file"
